# 시공ON - 권한 매트릭스

> **문서 버전**: 1.0.0
> **최종 수정일**: 2026-01-24
> **근거 문서**: 킥오프 미팅 (2026.01.21), 계약 전 미팅 기록

---

## 1. 문서 개요

### 1.1 목적

본 문서는 시공ON 플랫폼의 역할별 접근 권한을 정의합니다.

### 1.2 권한 표기법

| 기호 | 의미                    |
| :--: | ----------------------- |
|  ✅  | 전체 접근 (CRUD)        |
|  📖  | 읽기 전용               |
|  📝  | 생성/수정 (삭제 불가)   |
|  ❌  | 접근 불가               |
|  ⚙️  | 조건부 접근 (별도 설명) |

---

## 2. 사용자 역할 정의

### 2.1 역할 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                      슈퍼 어드민 (유니그린)                       │
│                           super_admin                           │
│            전체 시스템 관리, 고객사 관리, 적산정보 관리            │
└─────────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────┐
│                      고객사 대표                                 │
│                       company_admin                             │
│        해당 업체의 모든 기능 접근, 결제/정산, 일용직 관리          │
└─────────────────────────────────────────────────────────────────┘
                               │
                ┌──────────────┴──────────────┐
                ▼                              ▼
┌──────────────────────────┐    ┌──────────────────────────┐
│       현장 소장           │    │     내부 직원 (추후)      │
│      site_manager        │    │       employee           │
│  배정된 프로젝트만 접근   │    │  대표와 유사, 일부 제한   │
│  현장 작업 중심 기능      │    │                          │
└──────────────────────────┘    └──────────────────────────┘
                │
                ▼
┌──────────────────────────┐
│       일용직 근로자       │
│         worker           │
│  본인 계약/지급 확인만    │
└──────────────────────────┘
```

### 2.2 역할별 설명

| 역할              | 코드            | 설명                              | 기본 제공 계정    |
| ----------------- | --------------- | --------------------------------- | ----------------- |
| **슈퍼 어드민**   | `super_admin`   | 유니그린 관리자. 전체 시스템 관리 | 유니그린 내부     |
| **고객사 대표**   | `company_admin` | 가입 업체의 대표/관리자           | 기본 1개          |
| **현장 소장**     | `site_manager`  | 현장 관리자. 시공 관련 기능       | 기본 1개 (플랜별) |
| **내부 직원**     | `employee`      | 업체 내부 직원 (추후 확장)        | 추가 구매         |
| **일용직 근로자** | `worker`        | 일용 근로자. 최소 기능            | 계약 시 자동      |

### 2.3 계정 수 정책

| 요금제    | 기본 포함             | 추가 가능 |
| --------- | --------------------- | --------- |
| 무료 체험 | 1명 (대표만)          | 불가      |
| Basic     | 2명 (대표 + 소장)     | 유료 추가 |
| Pro       | 5명 (대표 + 소장 4명) | 유료 추가 |

---

## 3. 기능별 권한 매트릭스

### 3.1 인증/계정 관리

| 기능                 | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| -------------------- | :--------: | :--------: | :------: | :----: |
| 로그인               |     ✅     |     ✅     |    ✅    |   ✅   |
| 비밀번호 변경 (본인) |     ✅     |     ✅     |    ✅    |   ✅   |
| 프로필 수정 (본인)   |     ✅     |     ✅     |    ✅    |   📝   |
| 회원 탈퇴            |     ✅     |     ✅     |    ❌    |   ❌   |
| **사용자 관리**      |            |            |          |        |
| 전체 사용자 목록     |     ✅     |     ❌     |    ❌    |   ❌   |
| 고객사 사용자 목록   |     ✅     |     ✅     |    ❌    |   ❌   |
| 사용자 생성          |     ✅     |     ✅     |    ❌    |   ❌   |
| 사용자 수정          |     ✅     |    ⚙️ 1    |    ❌    |   ❌   |
| 사용자 삭제/비활성화 |     ✅     |    ⚙️ 1    |    ❌    |   ❌   |
| 비밀번호 초기화      |     ✅     |     ✅     |    ❌    |   ❌   |

> ⚙️ 1: 고객사 대표는 자기 업체 소속 사용자만 관리 가능

---

### 3.2 업체(Organization) 관리

| 기능             | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ---------------- | :--------: | :--------: | :------: | :----: |
| 전체 업체 목록   |     ✅     |     ❌     |    ❌    |   ❌   |
| 업체 생성        |     ✅     |     ❌     |    ❌    |   ❌   |
| 업체 정보 조회   |     ✅     |     ✅     |    📖    |   ❌   |
| 업체 정보 수정   |     ✅     |     ✅     |    ❌    |   ❌   |
| 사업자 정보 변경 |     ✅     |     ✅     |    ❌    |   ❌   |
| 도장/인감 등록   |     ✅     |     ✅     |    ❌    |   ❌   |
| 업체 비활성화    |     ✅     |     ❌     |    ❌    |   ❌   |

---

### 3.3 프로젝트 관리

| 기능                   | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ---------------------- | :--------: | :--------: | :------: | :----: |
| **프로젝트 목록**      |            |            |          |        |
| 전체 프로젝트 목록     |     ✅     |     ❌     |    ❌    |   ❌   |
| 업체 프로젝트 목록     |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 배정된 프로젝트 목록   |    N/A     |    N/A     |    ✅    |  ⚙️ 3  |
| **프로젝트 CRUD**      |            |            |          |        |
| 프로젝트 생성          |     ✅     |     ✅     |    ❌    |   ❌   |
| 프로젝트 상세 조회     |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 프로젝트 수정          |     ✅     |     ✅     |    ❌    |   ❌   |
| 프로젝트 삭제          |     ✅     |     ✅     |    ❌    |   ❌   |
| 프로젝트 상태 변경     |     ✅     |     ✅     |    ❌    |   ❌   |
| **프로젝트 배정**      |            |            |          |        |
| 현장 소장 배정         |     ✅     |     ✅     |    ❌    |   ❌   |
| 일용직 배정            |     ✅     |     ✅     |    📝    |   ❌   |
| **공개/비공개 설정**   |            |            |          |        |
| 소장에게 프로젝트 표시 |    N/A     |     ✅     |    ❌    |   ❌   |

> ⚙️ 2: 현장소장은 자신에게 배정된 프로젝트만 접근 가능
> ⚙️ 3: 일용직은 자신이 계약한 프로젝트의 제한된 정보만 접근

---

### 3.4 현장방문/사진

| 기능               | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ------------------ | :--------: | :--------: | :------: | :----: |
| 현장방문 등록      |     📖     |     ✅     |    ✅    |   ❌   |
| 현장방문 목록 조회 |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 현장방문 상세 조회 |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 사진 촬영/업로드   |     ❌     |     ✅     |    ✅    |   ❌   |
| 사진 조회          |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 사진 삭제          |     📖     |     ✅     |    📝    |   ❌   |

---

### 3.5 AI 진단

| 기능                | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ------------------- | :--------: | :--------: | :------: | :----: |
| AI 진단 요청        |     ❌     |     ✅     |    ✅    |   ❌   |
| 진단 결과 조회      |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 진단서 PDF 다운로드 |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 진단 결과 수정      |     ❌     |     ✅     |    ❌    |   ❌   |

---

### 3.6 견적 관리

| 기능                  | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| --------------------- | :--------: | :--------: | :------: | :----: |
| 견적서 목록 조회      |     ✅     |     ✅     |    ❌    |   ❌   |
| 견적서 생성           |     ❌     |     ✅     |    ❌    |   ❌   |
| 견적서 편집           |     ❌     |     ✅     |    ❌    |   ❌   |
| 견적서 상세 조회      |     ✅     |     ✅     |    ❌    |   ❌   |
| 견적서 발송           |     ❌     |     ✅     |    ❌    |   ❌   |
| 견적서 PDF 다운로드   |     ✅     |     ✅     |    ❌    |   ❌   |
| 견적서 Excel 다운로드 |     ❌     |     ✅     |    ❌    |   ❌   |
| 견적서 삭제 (초안만)  |     ❌     |     ✅     |    ❌    |   ❌   |

> 💡 **금액 정보 가시성**: 현장소장에게는 견적/계약 금액 정보가 **기본적으로 숨겨짐**

---

### 3.7 계약 관리

| 기능                | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ------------------- | :--------: | :--------: | :------: | :----: |
| 계약서 목록 조회    |     ✅     |     ✅     |    ❌    |   ❌   |
| 계약서 생성         |     ❌     |     ✅     |    ❌    |   ❌   |
| 계약서 편집         |     ❌     |     ✅     |    ❌    |   ❌   |
| 계약서 상세 조회    |     ✅     |     ✅     |    ❌    |   ❌   |
| 전자서명 요청       |     ❌     |     ✅     |    ❌    |   ❌   |
| 계약서 PDF 다운로드 |     ✅     |     ✅     |    ❌    |   ❌   |

---

### 3.8 시공 관리

| 기능               | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ------------------ | :--------: | :--------: | :------: | :----: |
| 착공계 작성        |     ❌     |     ✅     |    ✅    |   ❌   |
| 착공계 조회        |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| **작업일지**       |            |            |          |        |
| 작업일지 작성      |     ❌     |     ✅     |    ✅    |   ❌   |
| 작업일지 목록 조회 |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 작업일지 상세 조회 |     ✅     |     ✅     |   ⚙️ 2   |   ❌   |
| 작업일지 수정      |     ❌     |     ✅     |   ⚙️ 4   |   ❌   |
| **준공 처리**      |            |            |          |        |
| 준공계 작성        |     ❌     |     ✅     |    ✅    |   ❌   |
| 준공사진첩 생성    |     ❌     |     ✅     |    ✅    |   ❌   |
| 하자보증서 발급    |     ❌     |     ✅     |    ❌    |   ❌   |

> ⚙️ 4: 현장소장은 본인이 작성한 작업일지만 당일에 수정 가능

---

### 3.9 일용직/노무 관리

| 기능                 | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| -------------------- | :--------: | :--------: | :------: | :----: |
| **일용직 등록**      |            |            |          |        |
| 일용직 목록 조회     |     ✅     |     ✅     |   ⚙️ 5   |   ❌   |
| 일용직 등록          |     ❌     |     ✅     |    ✅    |   ❌   |
| 일용직 정보 수정     |     ❌     |     ✅     |    ❌    |   ❌   |
| 일용직 비활성화      |     ❌     |     ✅     |    ❌    |   ❌   |
| **근로계약**         |            |            |          |        |
| 근로계약서 작성      |     ❌     |     ✅     |    ❌    |   ❌   |
| 근로계약서 발송      |     ❌     |     ✅     |    ❌    |   ❌   |
| 근로계약 목록 조회   |     ✅     |     ✅     |   ⚙️ 5   |  ⚙️ 6  |
| 근로계약서 서명      |     ❌     |     ❌     |    ❌    |   ✅   |
| **출근/일당 관리**   |            |            |          |        |
| 출근 체크            |     ❌     |     ✅     |    ✅    |   ❌   |
| 일당 확정            |     ❌     |     ✅     |    ❌    |   ❌   |
| 지급명세서 발급      |     ❌     |     ✅     |    ❌    |   ❌   |
| 지급명세서 조회      |     ✅     |     ✅     |    ❌    |  ⚙️ 6  |
| 지급명세서 수령 확인 |     ❌     |     ❌     |    ❌    |   ✅   |
| **신고자료**         |            |            |          |        |
| 신고자료 출력        |     ❌     |     ✅     |    ❌    |   ❌   |

> ⚙️ 5: 현장소장은 배정된 프로젝트의 일용직 정보만 조회
> ⚙️ 6: 일용직은 본인의 계약/지급 정보만 조회

---

### 3.10 문서 관리

| 기능             | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ---------------- | :--------: | :--------: | :------: | :----: |
| 문서함 접근      |     ✅     |     ✅     |   ⚙️ 7   |   ❌   |
| 문서 다운로드    |     ✅     |     ✅     |   ⚙️ 7   |  ⚙️ 6  |
| 문서 이메일 발송 |     ❌     |     ✅     |    ❌    |   ❌   |
| 문서 삭제        |     ❌     |     ✅     |    ❌    |   ❌   |

> ⚙️ 7: 현장소장은 작업일지, 사진 등 시공 관련 문서만 접근

---

### 3.11 결제/구독 관리

| 기능                | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ------------------- | :--------: | :--------: | :------: | :----: |
| 전체 결제 이력 조회 |     ✅     |     ❌     |    ❌    |   ❌   |
| 업체 결제 이력 조회 |     ✅     |     ✅     |    ❌    |   ❌   |
| 요금제 변경         |     ❌     |     ✅     |    ❌    |   ❌   |
| 결제 수단 관리      |     ❌     |     ✅     |    ❌    |   ❌   |
| 추가 사용자 구매    |     ❌     |     ✅     |    ❌    |   ❌   |
| 구독 취소           |     ❌     |     ✅     |    ❌    |   ❌   |
| **세금계산서**      |            |            |          |        |
| 세금계산서 발행     |     ❌     |     ✅     |    ❌    |   ❌   |
| 세금계산서 조회     |     ✅     |     ✅     |    ❌    |   ❌   |

---

### 3.12 슈퍼 어드민 전용 기능

| 기능                | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ------------------- | :--------: | :--------: | :------: | :----: |
| **고객사 관리**     |            |            |          |        |
| 전체 고객사 목록    |     ✅     |     ❌     |    ❌    |   ❌   |
| 고객사 상세 조회    |     ✅     |     ❌     |    ❌    |   ❌   |
| 고객사 생성/수정    |     ✅     |     ❌     |    ❌    |   ❌   |
| 고객사 비활성화     |     ✅     |     ❌     |    ❌    |   ❌   |
| **적산정보 관리**   |            |            |          |        |
| 적산정보 PDF 업로드 |     ✅     |     ❌     |    ❌    |   ❌   |
| 단가 버전 관리      |     ✅     |     ❌     |    ❌    |   ❌   |
| 단가 항목 조회/수정 |     ✅     |     ❌     |    ❌    |   ❌   |
| RAG DB 관리         |     ✅     |     ❌     |    ❌    |   ❌   |
| **요금제 관리**     |            |            |          |        |
| 요금제 설정         |     ✅     |     ❌     |    ❌    |   ❌   |
| 프로모션/쿠폰 관리  |     ✅     |     ❌     |    ❌    |   ❌   |
| **시스템 관리**     |            |            |          |        |
| 시스템 설정         |     ✅     |     ❌     |    ❌    |   ❌   |
| 알림 템플릿 관리    |     ✅     |     ❌     |    ❌    |   ❌   |
| 문서 템플릿 관리    |     ✅     |     ❌     |    ❌    |   ❌   |
| 시스템 공지사항     |     ✅     |     ❌     |    ❌    |   ❌   |
| **통계/리포트**     |            |            |          |        |
| 전체 통계 대시보드  |     ✅     |     ❌     |    ❌    |   ❌   |
| 매출 리포트         |     ✅     |     ❌     |    ❌    |   ❌   |
| 사용량 리포트       |     ✅     |     ❌     |    ❌    |   ❌   |

---

## 4. 화면별 접근 권한

### 4.1 웹 관리자 화면

| 화면          | 최고관리자 | 고객사대표  | 현장소장 | 일용직 |
| ------------- | :--------: | :---------: | :------: | :----: |
| 로그인        |     ✅     |     ✅      |    ✅    |   ❌   |
| 대시보드      | ✅ (슈퍼)  | ✅ (고객사) |    ❌    |   ❌   |
| 프로젝트 목록 |     ✅     |     ✅      |    ❌    |   ❌   |
| 프로젝트 상세 |     ✅     |     ✅      |    ❌    |   ❌   |
| 견적서 편집   |     ❌     |     ✅      |    ❌    |   ❌   |
| 계약 관리     |     ✅     |     ✅      |    ❌    |   ❌   |
| 일용직 관리   |     ✅     |     ✅      |    ❌    |   ❌   |
| 문서함        |     ✅     |     ✅      |    ❌    |   ❌   |
| 설정          |     ✅     |     ✅      |    ❌    |   ❌   |
| 결제/구독     |     ✅     |     ✅      |    ❌    |   ❌   |
| 고객사 관리   |     ✅     |     ❌      |    ❌    |   ❌   |
| 적산정보 관리 |     ✅     |     ❌      |    ❌    |   ❌   |
| 요금제 관리   |     ✅     |     ❌      |    ❌    |   ❌   |
| 시스템 설정   |     ✅     |     ❌      |    ❌    |   ❌   |

### 4.2 모바일 앱 화면

| 화면               | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ------------------ | :--------: | :--------: | :------: | :----: |
| 로그인             |     ❌     |     ✅     |    ✅    |   ✅   |
| 대시보드           |     ❌     |     ✅     |    ✅    |   ✅   |
| 프로젝트 목록      |     ❌     |     ✅     |    ✅    |   ❌   |
| 프로젝트 상세      |     ❌     |     ✅     |    ✅    |   ❌   |
| 현장방문 등록      |     ❌     |     ✅     |    ✅    |   ❌   |
| 사진 촬영          |     ❌     |     ✅     |    ✅    |   ❌   |
| AI 진단 요청       |     ❌     |     ✅     |    ✅    |   ❌   |
| 진단 결과          |     ❌     |     ✅     |    ✅    |   ❌   |
| 작업일지 작성      |     ❌     |     ✅     |    ✅    |   ❌   |
| 출근 관리          |     ❌     |     ✅     |    ✅    |   ❌   |
| 일용직 등록        |     ❌     |     ✅     |    ✅    |   ❌   |
| 알림               |     ❌     |     ✅     |    ✅    |   ✅   |
| 프로필             |     ❌     |     ✅     |    ✅    |   ✅   |
| **일용직 전용**    |            |            |          |        |
| 근로계약 확인/서명 |     ❌     |     ❌     |    ❌    |   ✅   |
| 지급명세서 확인    |     ❌     |     ❌     |    ❌    |   ✅   |
| 수령 확인          |     ❌     |     ❌     |    ❌    |   ✅   |

---

## 5. 데이터 가시성 규칙

### 5.1 금액 정보 가시성

| 데이터      | 최고관리자 | 고객사대표 | 현장소장 | 일용직 |
| ----------- | :--------: | :--------: | :------: | :----: |
| 견적 금액   |     ✅     |     ✅     |    ❌    |   ❌   |
| 계약 금액   |     ✅     |     ✅     |    ❌    |   ❌   |
| 자재 단가   |     ✅     |     ✅     |    ❌    |   ❌   |
| 일용직 일당 |     ✅     |     ✅     |    ⚙️    |   ⚙️   |
| 지급 총액   |     ✅     |     ✅     |    ❌    |   ⚙️   |
| 매출 통계   |     ✅     |     ✅     |    ❌    |   ❌   |

> ⚙️ 일용직 일당: 현장소장은 출근 관리 시에만 확인, 일용직은 본인 것만

### 5.2 개인정보 가시성

| 데이터                 | 최고관리자 | 고객사대표 | 현장소장 |  일용직   |
| ---------------------- | :--------: | :--------: | :------: | :-------: |
| 일용직 주민번호 전체   |     ✅     |     ✅     |    ❌    | ✅ (본인) |
| 일용직 주민번호 마스킹 |     ✅     |     ✅     |    ✅    |    ✅     |
| 일용직 연락처          |     ✅     |     ✅     |    ✅    | ✅ (본인) |
| 일용직 계좌정보        |     ✅     |     ✅     |    ❌    | ✅ (본인) |
| 발주처 연락처          |     ✅     |     ✅     |    ⚙️    |    ❌     |

> ⚙️ 발주처 연락처: 배정된 프로젝트에 한해 제한적 접근

### 5.3 프로젝트별 가시성 제어

고객사 대표는 현장 소장에게 **프로젝트 단위로 가시성을 제어**할 수 있습니다.

```
┌─────────────────────────────────────────────────────────────────┐
│  프로젝트: 강남아파트 옥상방수                                   │
│                                                                 │
│  현장 소장 배정: 김소장                                          │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │  가시성 설정                                               │ │
│  │                                                            │ │
│  │  ● 전체 공개 (기본)                                        │ │
│  │    - 프로젝트 상세 정보                                    │ │
│  │    - 현장방문/사진                                         │ │
│  │    - 작업일지                                              │ │
│  │    - 배정된 일용직 정보                                    │ │
│  │                                                            │ │
│  │  ○ 숨김                                                    │ │
│  │    - 프로젝트가 목록에서 보이지 않음                        │ │
│  │                                                            │ │
│  │  ※ 금액 정보는 항상 숨김                                   │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. API 권한 검증

### 6.1 인증 미들웨어

```python
from fastapi import Depends, HTTPException
from app.core.security import get_current_user

def require_role(*allowed_roles):
    """역할 기반 접근 제어 데코레이터"""
    async def role_checker(
        current_user: User = Depends(get_current_user)
    ):
        if current_user.role not in allowed_roles:
            raise HTTPException(
                status_code=403,
                detail="이 기능에 대한 접근 권한이 없습니다"
            )
        return current_user
    return role_checker

# 사용 예시
@router.post("/estimates")
async def create_estimate(
    request: EstimateCreate,
    current_user: User = Depends(require_role("company_admin"))
):
    ...
```

### 6.2 리소스 소유권 검증

```python
async def verify_project_access(
    project_id: UUID,
    current_user: User,
    required_permission: str = "read"
) -> Project:
    """프로젝트 접근 권한 검증"""

    project = await get_project(project_id)

    # 슈퍼 어드민은 모든 프로젝트 접근 가능
    if current_user.role == "super_admin":
        return project

    # 같은 조직 소속 확인
    if project.organization_id != current_user.organization_id:
        raise HTTPException(status_code=403)

    # 현장 소장은 배정된 프로젝트만
    if current_user.role == "site_manager":
        if project.site_manager_id != current_user.id:
            raise HTTPException(status_code=403)

        # 가시성 설정 확인
        if not project.is_visible_to_manager:
            raise HTTPException(status_code=403)

    # 일용직은 계약된 프로젝트의 제한된 정보만
    if current_user.role == "worker":
        contract = await get_worker_contract(
            worker_id=current_user.worker_id,
            project_id=project_id
        )
        if not contract:
            raise HTTPException(status_code=403)

    return project
```

### 6.3 필드 레벨 권한

```python
class ProjectResponse(BaseModel):
    id: UUID
    name: str
    address: str
    status: str

    # 조건부 필드
    contract_amount: Optional[int] = None
    estimate_amount: Optional[int] = None

    class Config:
        @staticmethod
        def json_schema_extra(schema, model):
            # 권한에 따라 필드 숨김 처리
            pass

def filter_project_response(
    project: Project,
    current_user: User
) -> ProjectResponse:
    """권한에 따른 응답 필터링"""

    response = ProjectResponse(
        id=project.id,
        name=project.name,
        address=project.address,
        status=project.status
    )

    # 금액 정보는 대표자/최고관리자만
    if current_user.role in ["super_admin", "company_admin"]:
        response.contract_amount = project.contract_amount
        response.estimate_amount = project.estimate_amount

    return response
```

---

## 7. 오픈 이슈 및 추후 결정 사항

### 7.1 확정 필요 항목

| 항목              | 현재 상태 | 결정 필요 사항                                     |
| ----------------- | --------- | -------------------------------------------------- |
| 내부 직원 권한    | 미정의    | 대표자와 유사하나 결제 권한 제외 등 세부 정의 필요 |
| 협력사 권한       | 미정의    | 협력사 계정 필요 시 별도 역할 정의                 |
| 발주처 계정       | 미정의    | 견적서 승인 등 별도 포털 필요 여부                 |
| 권한 커스터마이징 | 미지원    | 고객사별 권한 세부 조정 기능                       |

### 7.2 향후 확장 예정

- 역할별 기능 제한 세분화
- 프로젝트 단위 권한 상세 설정
- 감사 로그 (권한 변경 이력)
- 임시 권한 부여 (만료일 설정)

---

## 8. 버전 이력

| 버전  | 날짜       | 작성자 | 변경 내용                               |
| ----- | ---------- | ------ | --------------------------------------- |
| 1.0.1 | 2026-02-19 | Codex  | 1/21 회의 기준 반영: 현장소장 착공/준공 작성 권한 조정 |
| 1.0.0 | 2026-01-24 | Claude | 최초 작성 - 4개 역할 권한 매트릭스 정의 |

---

## 9. 부록: 권한 체크리스트

### 새 기능 추가 시 확인 사항

- [ ] 각 역할별 접근 권한 정의
- [ ] API 엔드포인트에 role checker 적용
- [ ] 리소스 소유권 검증 로직 추가
- [ ] 필드 레벨 필터링 필요 여부 확인
- [ ] 본 문서에 권한 매트릭스 업데이트
- [ ] 테스트 케이스에 권한 테스트 추가
